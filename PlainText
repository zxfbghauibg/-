
### 各层职责
| 层级   | 核心职责                                                                 |
| ------ | ------------------------------------------------------------------------ |
| 前端层 | 负责用户界面渲染、交互逻辑处理、数据可视化展示，通过 Axios 调用后端 API。 |
| 后端层 | 提供 RESTful API 接口，处理业务逻辑、权限校验、数据持久化，通过 MyBatis 操作数据库。 |
| 数据层 | 存储业务数据（MySQL），缓存高频访问数据（如库存、字典表）以提升性能（Redis）。 |

## 核心业务模块设计

### 1. 基础信息管理模块

#### 功能描述
维护系统基础数据，为其他模块提供支撑，包括商品、供应商、仓库、用户与权限管理。

#### 核心功能点
| 功能子模块   | 具体功能                                                                 |
| ------------ | ------------------------------------------------------------------------ |
| 商品管理     | 商品分类（多级分类）、SKU 信息维护（编码、规格、单价）、供应商关联、库存阈值设置。 |
| 供应商管理   | 供应商信息录入（名称、联系人、资质文件）、合作状态管理、供应商品范围维护。 |
| 仓库管理     | 仓库信息（位置、容量）、库位划分（分区编码）、仓库负责人关联。           |
| 用户与权限   | 基于 RBAC 模型的角色定义（采购员、库管员、财务）、权限分配（菜单/按钮级控制）。 |

#### 技术实现
- 前端：使用el-table展示数据列表，el-dialog实现新增/编辑表单，Pinia 存储全局字典（如商品分类）。
- 后端：
  - 实体类：Goods、Supplier、Warehouse、User、Role
  - Mapper 层：通过 MyBatis 实现 CRUD，resultMap处理商品-供应商多对多关联
  - 接口示例：GET /api/goods（查询商品列表）、POST /api/supplier（新增供应商）

### 2. 采购管理模块

#### 功能描述
实现从采购计划制定到订单执行的全流程管理，确保商品按需采购。

#### 核心功能点
| 功能子模块 | 具体功能                                                               |
| ---------- | ---------------------------------------------------------------------- |
| 采购计划   | 自动生成（基于库存预警+销售数据）或手动创建计划，包含商品、数量、目标供应商。 |
| 采购订单   | 生成订单（关联计划、供应商、交货日期），支持审核、修改、取消操作。     |
| 订单跟踪   | 实时查看订单状态（待发货/已发货/部分收货/全部收货），关联入库单信息。  |

#### 技术实现
- 前端：用 ECharts 绘制采购量趋势图，el-select联动选择商品与供应商，el-timeline展示订单状态流转。
- 后端：
  - 业务逻辑：订单生成时校验供应商资质（合作状态）、商品库存上限
  - 事务控制：订单提交时锁定预采购量，避免重复采购
  - Mapper 层：PurchaseOrderMapper关联查询订单与商品明细（PurchaseOrderItem）

### 3. 库存管理模块

#### 功能描述
实时监控库存状态，处理入库、出库、盘点等操作，确保库存数据准确。

#### 核心功能点
| 功能子模块 | 具体功能                                                               |
| ---------- | ---------------------------------------------------------------------- |
| 入库管理   | 采购到货后，库管员确认数量/质量，生成入库单，自动更新库存。            |
| 出库管理   | 根据门店要货单生成出库单，记录库位信息，扣减对应商品库存。             |
| 库存预警   | 设置最低/最高库存阈值，低于阈值时触发提醒（前端弹窗+系统消息）。       |
| 库存盘点   | 定期盘点，记录实际库存与系统差异，生成盘点报告，支持差异调整。         |

#### 技术实现
- 前端：el-badge显示预警商品数量，el-upload上传入库验收单图片，el-progress展示盘点完成率。
- 后端：
  - 事务管理：入库时同时更新inventory表与inbound_order表，保证数据一致性
  - 缓存优化：Redis 缓存热门商品库存（如销量 Top100），减少数据库查询
  - 定时任务：Spring Scheduler 每日检查库存阈值，触发预警逻辑

### 4. 配送管理模块

#### 功能描述
连接仓库与门店，管理商品配送全流程，确保商品及时送达。

#### 核心功能点
| 功能子模块 | 具体功能                                                               |
| ---------- | ---------------------------------------------------------------------- |
| 配送单管理 | 根据门店要货申请生成配送单，关联出库单、配送车辆、司机信息。           |
| 配送跟踪   | 记录配送状态（待配送/在途/已送达/异常），支持上传签收凭证（照片）。     |
| 路径优化   | 基于仓库与门店位置，推荐最优配送路线（集成第三方地图 API）。           |

#### 技术实现
- 前端：集成高德/百度地图 SDK，标记配送位置与路线；el-steps展示配送进度。
- 后端：
  - 状态机：Spring StateMachine 管理配送单状态流转（如"在途"不可直接改为"已取消"）
  - 接口示例：GET /api/delivery/track/{id}（实时查询配送位置）

### 5. 结算管理模块

#### 功能描述
处理与供应商的对账、付款流程，确保财务数据准确。

#### 核心功能点
| 功能子模块 | 具体功能                                                               |
| ---------- | ---------------------------------------------------------------------- |
| 对账管理   | 自动关联采购订单、入库单，生成对账单（数量、金额、扣款项）。           |
| 付款管理   | 财务审核对账单后生成付款单，记录付款金额、方式、时间，支持凭证上传。   |
| 报表统计   | 按周期（月/季）生成供应商应付/已付/欠款报表，支持 Excel 导出。         |

#### 技术实现
- 前端：el-table展示对账单明细，xlsx库实现报表导出，el-steps展示付款审核流程。
- 后端：
  - 对账逻辑：通过采购订单号关联入库单，计算实际应付款（扣除破损/退货金额）
  - 权限控制：@PreAuthorize注解限制仅财务角色操作付款单

## 数据库设计

### 核心表结构（简化版）
| 表名              | 核心字段                                                               | 说明             |
| ----------------- | ---------------------------------------------------------------------- | ---------------- |
| goods             | id, name, category_id, spec, price, supplier_id, min_stock, max_stock  | 商品基础信息     |
| supplier          | id, name, contact, qualification_status, settlement_cycle, create_time | 供应商信息       |
| purchase_order    | id, supplier_id, create_time, status, check_user, total_amount         | 采购订单主表     |
| purchase_order_item | id, order_id, goods_id, quantity, unit_price, total_price             | 采购订单明细表   |
| inventory         | id, goods_id, warehouse_id, quantity, position_code, update_time       | 库存表           |
| delivery_order    | id, outbound_id, store_id, driver_id, status, delivery_time            | 配送单表         |
| settlement        | id, supplier_id, order_ids, total_amount, status, pay_time             | 对账单表         |

### 索引设计
- 为频繁查询字段建立索引：goods.supplier_id、inventory.goods_id、purchase_order.status
- 为关联字段建立外键：purchase_order.supplier_id 关联 supplier.id，保证数据一致性

## 系统部署

### 前端部署
1. 构建前端项目：`npm run build`
2. 将构建产物部署到 Nginx 服务器

### 后端部署
1. 打包后端服务：`mvn clean package`
2. 使用 Docker 构建镜像并运行容器

### 数据库配置
1. 导入 MySQL 初始化脚本
2. 配置 Redis 缓存服务

## 开发指南

### 环境要求
- JDK 1.8+
- Maven 3.6+
- Node.js 14+
- MySQL 5.7+
- Redis 6.0+

### 开发流程
1. Fork 项目仓库
2. 克隆到本地：`git clone [仓库地址]`
3. 前后端分别安装依赖
4. 启动开发服务器进行本地开发
5. 提交代码并创建 Pull Request

## 系统演示

### 登录页面
系统提供统一的登录入口，支持用户名密码登录。

### 功能演示
- 商品管理：商品信息的增删改查操作
- 采购流程：从计划制定到订单执行的全流程演示
- 库存管理：入库、出库、库存预警功能演示
- 配送跟踪：实时查看配送状态和位置信息
- 财务结算：对账和付款流程演示

## 联系与支持

如有问题或建议，请联系系统管理员。

---
